#!/usr/bin/env zsh
# prog-layout expects exactly 5 opened windows
[[ $(kwmc query window list | wc -l | xargs) == 5 ]] || exit 1
local bin="$(dirname "$0")"
kwmc tree restore prog
sleep 0.5

# Move Telegram window to top right corner
local telegram_id=$("$bin/get-window-id" Telegram)
kwmc window -f "$telegram_id"
"$bin/move-window" top-right

# Move iTerm to top left corner
local iterm_id=$("$bin/get-window-id" iTerm2)
kwmc window -f "$iterm_id"
"$bin/move-window" top-left

# Move Sublime Text window to bottom left corner
local sublime_text_id=$("$bin/get-window-id" "Sublime Text")
kwmc window -f "$sublime_text_id"
"$bin/move-window" bottom-left

# Move Google Chrome window to the right of Sublime Text window
local google_chrome_id=$("$bin/get-window-id" "Google Chrome")
kwmc window -f "$google_chrome_id"
if [[ $(kwmc query window focused west) != "$sublime_text_id" ]] ; then
  "$bin/move-window" bottom-right
fi
kwmc window -f "$google_chrome_id"
while [[ $(kwmc query window focused west) != "$sublime_text_id" ]] ; do
  kwmc window -f "$google_chrome_id"
  kwmc window -s west
  kwmc window -s south
done
